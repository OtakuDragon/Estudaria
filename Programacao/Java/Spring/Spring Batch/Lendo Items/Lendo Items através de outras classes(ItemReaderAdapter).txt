ItemReaderAdapter

Muitas vezes nós ja temos classes que lêem items,
e queremos queremos utiliza-las ao inves de utilizar
um ItemReader do spring batch.

O spring batch oferece uma maneira  facil de se adaptar
classes que não são ItemReaders para a utilização como
ItemReaders a classe ItemReaderAdapter é utilizada para
transformar classes normais de leitura de itens em ItemReaders 

A configurção de um ItemReaderAdapter requer duas
propriedades:

* targetObject -    uma referencia ao spring bean que implementa
						   o reader customizado, a única regra desta implementação
						   é que esta classe deve ter no minimo um método publico
						   que retorna o item sendo lido e não recebe parametros
						   
* targerMethod - nome do método descrito acima na classe, que representa o método read()
							do item reader.
							
Como a classe que o ItemReaderAdapter utiliza como targetObject
possui limitações para o metodo de leitura(sem parametros e retorna um objeto de item)
geralmente se cria esta classe como um adapter, e esta classe utiliza as
classes já existentes de leitura do sistema adaptando-as ao formato de leitura de um reader

IMPORTANTE: O método que representa o read() do adapter, será chamado pelo spring	batch
					    até que ele retorne null, o reader só para de ler quando o método de leitura de item retorna null

Obs: na utilização da leitura por ItemReaderAdapter o spring perde o controle do step
	     durante a fase da leitura, já que o reader é uma classe customizada não gerenciada pelo spring
		 da mesma maneira de que os readers proprietarios portanto o estado de execução de leitura não 
		 é mantido, o que no caso de um restart faz com que a leitura comece novamente.
=============================================================
Exemplos
----------------------------------------------------------------------------------------------------------------
Configuração XML

<bean id="productItemReader" class="org.springframework.batch.item.adapter.ItemReaderAdapter">
	<property name="targetObject" ref="productServiceAdapter"/>
	<property name="targetMethod" value="nextProduct"/>
</bean>
<bean id="productServiceAdapter" class="com.manning.sbia.reading.service.ProductServiceAdapter">
	<property name="productService" ref="productService"/>
</bean>
<bean id="productService" class="com.manning.sbia.reading.service.ProductServiceImpl">
(...)
</bean>
--------------------------------------------------------------------------------------------------------------
Classe adapter

public class ProductServiceAdapter implements InitializingBean {
	//Serviço já existente que faz a leitura
	private ProductService productService;
	private List<Product> products;
	
	//Inicialização do adapter com a lista de items retornada pelo serviço
	//de leitura(classe customizada)
	public void afterPropertiesSet() throws Exception {
		this.products = productService.getProducts();
	}
	
	//método utilizado como o read() do ItemReader customizado,
	// ele itera sobre a lista que o serviço retorna ja que readers leem
	//items um a um.
	public Product nextProduct() {
		if (products.size()>0) {
			return products.remove(0);
		} else {
			return null;
		}
	}

	public void setProductService(ProductService productService) {
	this.productService = productService;
	}
}

